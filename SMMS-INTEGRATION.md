# SM.MS 图片上传集成说明

## 概述

本项目已集成SM.MS图床服务，用于上传和管理网站logo等图片资源。通过SM.MS API，可以方便地上传图片并获取永久链接。

## 功能特性

### 1. 图片上传功能
- 支持拖拽上传和点击选择文件
- 支持多种图片格式：JPG、PNG、GIF、WebP、SVG
- 文件大小限制：最大5MB（网站图标限制2MB）
- 实时上传进度显示
- 上传成功后自动复制图片URL

### 2. 账户管理
- 显示SM.MS账户信息
- 查看存储使用情况
- 账户类型显示（普通用户/VIP）

### 3. 集成位置
- 管理后台 → 图片上传页面
- 网站管理 → 添加/编辑网站时的图标上传
- 分类管理 → 分类图标上传（可选）

## 使用方法

### 在管理后台使用

1. **访问图片上传页面**
   - 进入管理后台
   - 点击左侧菜单"图片上传"
   - 查看账户信息和上传图片

2. **上传图片**
   - 拖拽图片到上传区域或点击选择文件
   - 选择图片文件（支持JPG、PNG、GIF、WebP、SVG）
   - 点击"上传到SM.MS"按钮
   - 等待上传完成，复制生成的图片URL

### 在网站管理中使用

1. **添加新网站**
   - 进入网站管理页面
   - 点击"添加网站"按钮
   - 在"网站图标"字段点击"上传"按钮
   - 在弹出的对话框中上传图片
   - 上传成功后图标URL会自动填入表单

2. **编辑现有网站**
   - 在网站列表中找到要编辑的网站
   - 点击"编辑"按钮
   - 在图标字段点击"上传"按钮更换图标
   - 保存更改

## 技术实现

### API路由
- `POST /api/upload` - 上传图片到SM.MS
- `GET /api/upload` - 获取SM.MS账户信息

### 核心文件
- `lib/smms-api.ts` - SM.MS API封装
- `components/admin/ImageUploader.tsx` - 图片上传组件
- `components/admin/WebsiteForm.tsx` - 网站表单（集成图片上传）
- `app/admin/upload/page.tsx` - 图片上传管理页面

### 配置信息
- API Token: `dtjjrDw6kuSY1VWfmbPLoKVoTFbFh2cI`
- API Base URL: `https://sm.ms/api/v2`
- 支持的文件格式: `image/jpeg`, `image/png`, `image/gif`, `image/webp`, `image/svg+xml`

## 注意事项

### 1. 文件大小限制
- 普通图片：最大5MB
- 网站图标：最大2MB（推荐使用SVG格式）

### 2. 图片格式建议
- 网站图标：优先使用SVG格式，保证清晰度
- 普通图片：使用WebP格式，文件更小
- 兼容性：JPG和PNG格式兼容性最好

### 3. 使用建议
- 上传前压缩图片，减少文件大小
- 使用合适的图片尺寸，避免过大
- 定期清理不需要的图片，节省存储空间

### 4. 安全注意事项
- API Token已配置在代码中，请勿泄露
- 上传的图片会永久保存在SM.MS，请确保内容合规
- 建议定期更换API Token

## 故障排除

### 常见问题

1. **上传失败**
   - 检查网络连接
   - 确认文件格式和大小符合要求
   - 查看浏览器控制台错误信息

2. **无法获取账户信息**
   - 检查API Token是否正确
   - 确认SM.MS服务是否正常

3. **图片显示异常**
   - 检查图片URL是否有效
   - 确认图片格式是否支持
   - 查看图片是否被删除

### 错误处理
- 所有错误都会在界面上显示
- 详细错误信息会记录在浏览器控制台
- 网络错误会自动重试

## 更新日志

### v1.0.0 (2024-01-XX)
- 初始版本发布
- 集成SM.MS API
- 实现图片上传功能
- 添加网站图标上传支持
- 创建图片上传管理页面

## 技术支持

如有问题，请检查：
1. 网络连接是否正常
2. SM.MS服务是否可用
3. API Token是否有效
4. 文件格式和大小是否符合要求

更多信息请参考：[SM.MS API文档](https://sm.ms/doc/)
